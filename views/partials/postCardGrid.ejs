
  <% /* views/partials/postCardGrid.ejs */ %>
<div class="col">
  <div class="card shadow-sm rounded">
    <a href="/posts/<%= post._id %>">
      <img
        src="<%= post.coverImage || post.steps[0]?.image || '/images/default.jpg' %>"
        class="card-img-top"
        alt="Post Image"
      >
    </a>
    <div class="card-body">
      <a href="/posts/<%= post._id %>" style="text-decoration:none; color:inherit;">
        <h5 class="card-title mb-1 fw-bold"><%= post.title %></h5>
      </a>

      <div class="d-flex flex-wrap gap-2 mb-2">
        <% post.tags.forEach(tag => { %>
          <a
            href="/tags/<%= encodeURIComponent(tag) %>"
            class="badge bg-light text-dark text-decoration-none me-1 mb-1"
          >
            #<%= tag %>
          </a>
        <% }) %>
      </div>

      <div class="d-flex justify-content-between">
        <% const liked = post.likedBy.some(u => u._id.toString() === currentUser?.toString()); %>
        <form action="/posts/<%= post._id %>/like" method="POST" class="like-form" data-post-id="<%= post._id %>">
          <button type="submit" class="btn btn-light border-0">
            <i class="<%= liked ? 'bi bi-heart-fill text-danger' : 'bi bi-heart text-secondary' %>"></i>
            <span class="like-count"><%= post.likedBy.length %></span>
          </button>
        </form>

        <% const bookmarked = post.bookmarkedBy.some(u => u._id.toString() === currentUser?.toString()); %>
        <form action="/posts/<%= post._id %>/bookmark" method="POST">
          <button type="submit" class="btn btn-light border-0">
            <i class="<%= bookmarked ? 'bi bi-bookmark-fill text-primary' : 'bi bi-bookmark text-secondary' %>"></i>
          </button>
        </form>
      </div>
    </div>
  </div>
</div>



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js"></script>
